name: Ubuntu 24 Scopy Build

on: [push, pull_request]

env:
  BUILD_HOST: ubuntu-24
  USERNAME: github-actions

jobs:
  docker_tag_workflow:
    uses: ./.github/workflows/get_docker_tag.yml

  build_scopy_on_ubuntu20:
    runs-on: ubuntu-latest
    needs: docker_tag_workflow
    container:
        image: cristianbindea/scopy2-ubuntu24:${{ needs.docker_tag_workflow.outputs.docker_tag }}
        options: --user root
    steps:
        - name: check storage space
          run: df -h
        - uses: actions/checkout@v4
        - name: Build Scopy
          run: |
            /bin/bash -c "git config --global --add safe.directory $GITHUB_WORKSPACE"
            /bin/bash -c "export CI_SCRIPT=ON && $GITHUB_WORKSPACE/ci/ubuntu/ubuntu_build_process.sh build_scopy"
        - name: check storage space
          run: df -h